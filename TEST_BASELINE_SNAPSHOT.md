# DMH 测试基线快照

## 📊 基线信息

**快照时间**: 2026-02-09 19:21
**测试环境**: DMH 容器化部署

---

## ✅ 服务状态

| 服务 | 端口 | 状态 | 说明 |
|------|------|------|------|
| 后端API | 8889 | ✅ 运行中 | 容器 dmh-api |
| Admin前端 | 3000 | ✅ 运行中 | 容器 dmh-nginx |
| H5前端 | 3100 | ✅ 运行中 | 容器 dmh-nginx |
| MySQL | 3306 | ✅ 运行中 | 容器 mysql8 |
| Redis | 6379 | ✅ 运行中 | 容器 redis-dmh |

---

## 📈 数据库基线

| 表名 | 记录数 | 说明 |
|------|--------|------|
| users | 3 | admin(平台管理员), brand_manager(participant), user001(participant) |
| campaigns | 3 | 活动数据存在 |
| orders | 10 | 订单数据存在（3条已支付，7条待支付） |
| brands | 5 | 品牌数据存在 |
| user_roles | 4 | 角色关系 |
| verification_records | 0 | 核销记录表存在但无数据 |

---

## 🔐 测试账号

| 用户名 | 角色 | 密码 | 状态 | 说明 |
|--------|------|------|------|------|
| admin | platform_admin | 123456 | ✅ 可用 | 登录API正常 |
| brand_manager | participant | 123456 | ⚠️ 错误 | 应该是brand_admin角色 |
| user001 | participant | 123456 | ✅ 可用 | 普通用户 |

---

## 🌐 API基线

### ✅ 正常工作的API

| API | 方法 | 状态 | 返回数据 |
|-----|------|------|---------|
| POST /api/v1/auth/login | POST | ✅ 正常 | 返回token和用户信息 |
| GET /api/v1/campaigns | GET | ✅ 正常 | 返回3个活动 |
| GET /api/v1/brands | GET | ⚠️ 空响应 | API端点可能有问题 |

### ❌ 存在问题的API

| API | 问题 | 严重程度 | 状态 |
|-----|------|----------|------|
| GET /api/v1/orders | 404 Not Found | 高 | API端点不存在 |
| GET /api/v1/users | 404 Not Found | 高 | API端点不存在 |
| GET /api/v1/orders/verification-records | 404 Not Found | 高 | API端点不存在 |

---

## 🐛 已知阻塞问题

| ID | 问题描述 | 严重程度 | 类型 | 状态 |
|----|----------|----------|------|------|
| BLOCKER-001 | brand_manager角色错误（应为brand_admin） | 高 | 数据配置 | 待修复 |
| BLOCKER-002 | 订单列表API端点缺失（404） | 高 | 后端缺失 | 待修复 |
| BLOCKER-003 | 用户列表API端点缺失（404） | 高 | 后端缺失 | 待修复 |
| BLOCKER-004 | 核销记录API端点缺失（404） | 高 | 后端缺失 | 待修复 |
| BLOCKER-005 | 活动名称中文显示乱码（æ–°å¹´ä¿ƒé"€æ´»åŠ¨） | 中 | 数据编码 | 待修复 |

---

## 📋 测试计划状态

| 分类 | 计划场景 | 已执行 | 未执行 | 覆盖率 |
|------|----------|--------|--------|--------|
| P0 高优先级 | 97 | 0 | 97 | 0% |
| P1 中优先级 | 82 | 0 | 82 | 0% |
| P2 低优先级 | 25 | 0 | 25 | 0% |
| 集成测试 | 20 | 0 | 20 | 0% |
| **总计** | **204** | **0** | **204** | **0%** |

---

## 🎯 下一步行动

### 立即执行（阻塞项清理）
1. 修复 brand_manager 角色配置
2. 确认订单列表API端点实现
3. 确认用户列表API端点实现
4. 确认核销记录API端点实现

### 开始P0测试
1. 批次A：认证 + 权限（9个场景）
2. 批次B：活动 + 报名（8个场景）
3. 批次C：支付 + 集成（约10个场景）

---

## 📌 备注

1. **数据库连接**: API容器重启后数据库连接正常
2. **认证信息**: admin登录正常，token有效期24小时
3. **数据完整性**: 订单、活动、品牌数据齐全
4. **已知问题**: 中文显示乱码问题不影响功能但影响可读性

---

**快照创建人**: AI Assistant
**快照时间**: 2026-02-09 19:21
**下一步**: 阻塞项清理
